"use strict";(self.webpackChunknoobtechnote_github_io_source=self.webpackChunknoobtechnote_github_io_source||[]).push([[6383],{3905:(t,e,a)=>{a.d(e,{Zo:()=>d,kt:()=>c});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function i(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var o=n.createContext({}),m=function(t){var e=n.useContext(o),a=e;return t&&(a="function"==typeof t?t(e):p(p({},e),t)),a},d=function(t){var e=m(t.components);return n.createElement(o.Provider,{value:e},t.children)},u="mdxType",k={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},s=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,o=t.parentName,d=i(t,["components","mdxType","originalType","parentName"]),u=m(a),s=r,c=u["".concat(o,".").concat(s)]||u[s]||k[s]||l;return a?n.createElement(c,p(p({ref:e},d),{},{components:a})):n.createElement(c,p({ref:e},d))}));function c(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,p=new Array(l);p[0]=s;var i={};for(var o in e)hasOwnProperty.call(e,o)&&(i[o]=e[o]);i.originalType=t,i[u]="string"==typeof t?t:r,p[1]=i;for(var m=2;m<l;m++)p[m]=a[m];return n.createElement.apply(null,p)}return n.createElement.apply(null,a)}s.displayName="MDXCreateElement"},6068:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>p,default:()=>k,frontMatter:()=>l,metadata:()=>i,toc:()=>m});var n=a(87462),r=(a(67294),a(3905));const l={title:"Ch4: \u6700\u5927\u5316\u7684\u5229\u7528HTTP Protocol",sidebar_label:"Ch4: \u6700\u5927\u5316\u7684\u5229\u7528HTTP Protocol",sidebar_position:4},p=void 0,i={unversionedId:"sg/web-api-the-good-parts/ch4-maximize-utilization-of-http",id:"sg/web-api-the-good-parts/ch4-maximize-utilization-of-http",title:"Ch4: \u6700\u5927\u5316\u7684\u5229\u7528HTTP Protocol",description:"4.1 \u4f7f\u7528 HTTP \u5354\u8b70\u898f\u7bc4\u7684\u610f\u7fa9",source:"@site/docs/sg/web-api-the-good-parts/ch4-maximize-utilization-of-http.mdx",sourceDirName:"sg/web-api-the-good-parts",slug:"/sg/web-api-the-good-parts/ch4-maximize-utilization-of-http",permalink:"/docs/sg/web-api-the-good-parts/ch4-maximize-utilization-of-http",draft:!1,editUrl:"https://github.com/NoobTechNote/NoobTechNote.github.io/tree/main/docs/sg/web-api-the-good-parts/ch4-maximize-utilization-of-http.mdx",tags:[],version:"current",lastUpdatedBy:"zoe chen",lastUpdatedAt:1682994841,formattedLastUpdatedAt:"May 2, 2023",sidebarPosition:4,frontMatter:{title:"Ch4: \u6700\u5927\u5316\u7684\u5229\u7528HTTP Protocol",sidebar_label:"Ch4: \u6700\u5927\u5316\u7684\u5229\u7528HTTP Protocol",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Ch3: Design Response Data",permalink:"/docs/sg/web-api-the-good-parts/ch3-design-response-data"},next:{title:"Ch5: \u958b\u767c\u65b9\u4fbf\u66f4\u6539\u8a2d\u8a08\u7684 Web API",permalink:"/docs/sg/web-api-the-good-parts/ch5-design-apis-changed-easily"}},o={},m=[{value:"4.1 \u4f7f\u7528 HTTP \u5354\u8b70\u898f\u7bc4\u7684\u610f\u7fa9",id:"41-\u4f7f\u7528-http-\u5354\u8b70\u898f\u7bc4\u7684\u610f\u7fa9",level:2},{value:"4.2 \u6b63\u78ba\u4f7f\u7528\u72c0\u614b\u78bc",id:"42-\u6b63\u78ba\u4f7f\u7528\u72c0\u614b\u78bc",level:2},{value:"HTTP \u72c0\u614b\u78bc\u53ef\u5340\u5206\u70ba\u4e94\u5927\u985e\uff1a",id:"http-\u72c0\u614b\u78bc\u53ef\u5340\u5206\u70ba\u4e94\u5927\u985e",level:3},{value:"4.3 Cache \u8207 HTTP",id:"43-cache-\u8207-http",level:2},{value:"4.3.1 \u904e\u671f\u6a21\u578b(Expiration Model)",id:"431-\u904e\u671f\u6a21\u578bexpiration-model",level:3},{value:"4.3.2 \u9a57\u8b49\u6a21\u578b(Validation Model)",id:"432-\u9a57\u8b49\u6a21\u578bvalidation-model",level:3},{value:"4.3.3 \u555f\u767c\u5f0f\u904e\u671f(Heuristic Expiration)",id:"433-\u555f\u767c\u5f0f\u904e\u671fheuristic-expiration",level:3},{value:"4.3.4 \u4e0d\u5e0c\u671b\u5be6\u65bd\u7de9\u5b58\u7684\u60c5\u6cc1",id:"434-\u4e0d\u5e0c\u671b\u5be6\u65bd\u7de9\u5b58\u7684\u60c5\u6cc1",level:3},{value:"4.3.5 \u4f7f\u7528 Vary \u4f86\u6307\u5b9a\u7de9\u5b58\u55ae\u4f4d",id:"435-\u4f7f\u7528-vary-\u4f86\u6307\u5b9a\u7de9\u5b58\u55ae\u4f4d",level:3},{value:"4.4 Content-Type \u7684\u6307\u5b9a",id:"44-content-type-\u7684\u6307\u5b9a",level:2},{value:"\u8207 Content-Type \u6709\u95dc\u7684\u60c5\u5883",id:"\u8207-content-type-\u6709\u95dc\u7684\u60c5\u5883",level:3},{value:"Request \u6a19\u660e Server \u7684\u8655\u7406\u65b9\u5f0f",id:"request-\u6a19\u660e-server-\u7684\u8655\u7406\u65b9\u5f0f",level:4},{value:"Response \u63a7\u5236\u700f\u89bd\u5668\u7684\u884c\u70ba",id:"response-\u63a7\u5236\u700f\u89bd\u5668\u7684\u884c\u70ba",level:4},{value:"Response \u7684 Content Type",id:"response-\u7684-content-type",level:3},{value:"\u5e38\u898b\u7684 Content-Type",id:"\u5e38\u898b\u7684-content-type",level:4},{value:"X- \u958b\u982d\u7684 Content Type",id:"x--\u958b\u982d\u7684-content-type",level:4},{value:"\u81ea\u5b9a\u7fa9\u7684 Content Type",id:"\u81ea\u5b9a\u7fa9\u7684-content-type",level:4},{value:"Request \u7684 Content Type",id:"request-\u7684-content-type",level:3},{value:"Accept Header",id:"accept-header",level:4},{value:"Vary: Accept",id:"vary-accept",level:4},{value:"4.5 Same Origin Policy \u8207 CORS",id:"45-same-origin-policy-\u8207-cors",level:2},{value:"CORS\u8de8\u57df\u8acb\u6c42",id:"cors\u8de8\u57df\u8acb\u6c42",level:3},{value:"CORS\u7684Pre-flight Request",id:"cors\u7684pre-flight-request",level:3},{value:"\u6848\u4f8b\uff1aPCHome24\u8cfc\u7269\u6539\u7248",id:"\u6848\u4f8bpchome24\u8cfc\u7269\u6539\u7248",level:3},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:3},{value:"4.6 \u5b9a\u7fa9\u79c1\u6709\u7684 HTTP Header",id:"46-\u5b9a\u7fa9\u79c1\u6709\u7684-http-header",level:2},{value:"HTTP Header\u7684\u8c46\u77e5\u8b58",id:"http-header\u7684\u8c46\u77e5\u8b58",level:3},{value:"1. \u653e\u5728header\u7684\u8cc7\u8a0a\uff0c\u70ba\u4e86\u76f8\u5bb9\u6027\uff0c\u7e3d\u548c\u4e0d\u8981\u8d85\u904e8KB",id:"1-\u653e\u5728header\u7684\u8cc7\u8a0a\u70ba\u4e86\u76f8\u5bb9\u6027\u7e3d\u548c\u4e0d\u8981\u8d85\u904e8kb",level:4},{value:"2. Header Name\u662fcase-insensitive\u7684",id:"2-header-name\u662fcase-insensitive\u7684",level:4},{value:"3. Header\u7684\u9806\u5e8f\u4e0d\u91cd\u8981(\u55ce\uff1f)",id:"3-header\u7684\u9806\u5e8f\u4e0d\u91cd\u8981\u55ce",level:4}],d={toc:m},u="wrapper";function k(t){let{components:e,...l}=t;return(0,r.kt)(u,(0,n.Z)({},d,l,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"41-\u4f7f\u7528-http-\u5354\u8b70\u898f\u7bc4\u7684\u610f\u7fa9"},"4.1 \u4f7f\u7528 HTTP \u5354\u8b70\u898f\u7bc4\u7684\u610f\u7fa9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"- RFC (Request For Comments)\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"http_request_message_format",src:a(51718).Z,width:"660",height:"290"}),"\n",(0,r.kt)("img",{alt:"http_response_message_format",src:a(66506).Z,width:"660",height:"312"})),(0,r.kt)("p",null,"Image From:",(0,r.kt)("a",{parentName:"p",href:"http://www.tcpipguide.com/free/t_HTTPGenericMessageFormat.htm"},"The TCP/IP Guide")),(0,r.kt)("h2",{id:"42-\u6b63\u78ba\u4f7f\u7528\u72c0\u614b\u78bc"},"4.2 \u6b63\u78ba\u4f7f\u7528\u72c0\u614b\u78bc"),(0,r.kt)("h3",{id:"http-\u72c0\u614b\u78bc\u53ef\u5340\u5206\u70ba\u4e94\u5927\u985e"},"HTTP \u72c0\u614b\u78bc\u53ef\u5340\u5206\u70ba\u4e94\u5927\u985e\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"1xx \u6d88\u606f"),(0,r.kt)("li",{parentName:"ul"},"2xx \u6210\u529f"),(0,r.kt)("li",{parentName:"ul"},"3xx \u91cd\u65b0\u5c0e\u5411"),(0,r.kt)("li",{parentName:"ul"},"4xx \u5ba2\u6236\u7aef\u932f\u8aa4"),(0,r.kt)("li",{parentName:"ul"},"5xx \u4f3a\u670d\u5668\u932f\u8aa4")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4e3b\u8981\u7684\u72c0\u614b\u78bc")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Status code"),(0,r.kt)("th",{parentName:"tr",align:null},"Nmae"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"200"),(0,r.kt)("td",{parentName:"tr",align:null},"OK"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u6210\u529f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"201"),(0,r.kt)("td",{parentName:"tr",align:null},"Created"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u5df2\u88ab\u63a5\u53d7\uff0c\u65b0\u7684\u8cc7\u6e90\u5df2\u5275\u5efa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"Accepted"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u6210\u529f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"204"),(0,r.kt)("td",{parentName:"tr",align:null},"No Content"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6c92\u6709\u5167\u5bb9")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"300"),(0,r.kt)("td",{parentName:"tr",align:null},"Multiple Choices"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de\u591a\u689d\u91cd\u5b9a\u5411\u4f9b\u9078\u64c7")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"301"),(0,r.kt)("td",{parentName:"tr",align:null},"Moved Permanently"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6c38\u4e45\u91cd\u5b9a\u5411")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"302"),(0,r.kt)("td",{parentName:"tr",align:null},"Found"),(0,r.kt)("td",{parentName:"tr",align:null},"\u81e8\u65f6\u91cd\u5b9a\u5411")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"303"),(0,r.kt)("td",{parentName:"tr",align:null},"See Other"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7576\u524d\u8acb\u6c42\u7684\u8cc7\u6e90\u5728\u5176\u5b83\u5730\u5740")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"304"),(0,r.kt)("td",{parentName:"tr",align:null},"Not Modified"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u8cc7\u6e90\u8207\u672c\u5730\u7de9\u5b58\u76f8\u540c\uff0c\u672a\u4fee\u6539")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"307"),(0,r.kt)("td",{parentName:"tr",align:null},"Temporary Redirect"),(0,r.kt)("td",{parentName:"tr",align:null},"\u81e8\u6642\u91cd\u5b9a\u5411\uff0c\u540c 302")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"400"),(0,r.kt)("td",{parentName:"tr",align:null},"Bad Request"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u932f\u8aa4\uff0c\u901a\u5e38\u662f\u8a2a\u554f\u7684\u57df\u540d\u672a\u7d81\u5b9a\u5f15\u8d77")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"401"),(0,r.kt)("td",{parentName:"tr",align:null},"Unauthorized"),(0,r.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\u9a8c\u8bc1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Forbidden"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7981\u6b62\u8a2a\u554f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"404"),(0,r.kt)("td",{parentName:"tr",align:null},"Not Found"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u7684\u5167\u5bb9\u672a\u627e\u5230\u6216\u5df2\u522a\u9664")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"405"),(0,r.kt)("td",{parentName:"tr",align:null},"Method Not Allowed"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e0d\u5141\u8bb8\u7684\u8bf7\u6c42\u65b9\u6cd5")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"406"),(0,r.kt)("td",{parentName:"tr",align:null},"Not Acceptable"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7121\u6cd5\u97ff\u61c9\uff0c\u56e0\u8cc7\u6e90\u7121\u6cd5\u6eff\u8db3\u5ba2\u6236\u7aef\u689d\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"408"),(0,r.kt)("td",{parentName:"tr",align:null},"Request Timeout"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u8d85\u6642")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"409"),(0,r.kt)("td",{parentName:"tr",align:null},"Conflict"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b58\u5728\u885d\u7a81")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"410"),(0,r.kt)("td",{parentName:"tr",align:null},"Gone"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8cc7\u6e90\u5df2\u7d93\u4e0d\u5b58\u5728(\u904e\u53bb\u5b58\u5728)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"413"),(0,r.kt)("td",{parentName:"tr",align:null},"Payload Too Large"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u7684 URI \u904e\u9577")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"414"),(0,r.kt)("td",{parentName:"tr",align:null},"Request-URI Too Long"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8acb\u6c42\u8cc7\u6e90\u8207\u672c\u5730\u7de9\u5b58\u76f8\u540c\uff0c\u672a\u4fee\u6539")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"415"),(0,r.kt)("td",{parentName:"tr",align:null},"Unsupported Media Type"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7121\u6cd5\u8655\u7406\u7684\u5a92\u9ad4\u683c\u5f0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"429"),(0,r.kt)("td",{parentName:"tr",align:null},"Too Many Requests"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e26\u767c\u8acb\u6c42\u904e\u591a")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"500"),(0,r.kt)("td",{parentName:"tr",align:null},"Internal Server Error"),(0,r.kt)("td",{parentName:"tr",align:null},"\u670d\u52d9\u5668\u7aef\u7a0b\u5e8f\u932f\u8aa4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"503"),(0,r.kt)("td",{parentName:"tr",align:null},"Service Unavailable"),(0,r.kt)("td",{parentName:"tr",align:null},"\u670d\u52d9\u5668\u7aef\u81e8\u6642\u932f\u8aa4")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    "head": {\n        "errorCode": 1001,\n        "errorMessage": "Invalid parameter"\n    },\n    "body": {\n        :\n    }\n}\n')),(0,r.kt)("h2",{id:"43-cache-\u8207-http"},"4.3 Cache \u8207 HTTP"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6e1b\u5c11\u670d\u52d9\u5668\u7684\u9023\u7dda\u6578\u91cf\uff0c\u53ef\u4ee5\u63d0\u5347\u7528\u6236\u8a2a\u554f\u901f\u5ea6"),(0,r.kt)("li",{parentName:"ul"},"\u5728\u7db2\u8def\u9023\u7dda\u65b7\u958b\u7684\u72c0\u614b\u4e0b\u4e5f\u53ef\u4ee5\u5728\u67d0\u7a2e\u7a0b\u5ea6\u63d0\u4f9b\u670d\u52d9"),(0,r.kt)("li",{parentName:"ul"},"\u5ba2\u6236\u7aef\u5c07\u8cc7\u6599\u66ab\u5b58")),(0,r.kt)("admonition",{title:"Discussion",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u53cd\u5411\u4ee3\u7406\u670d\u52d9\u5668 Reverse Proxy")),(0,r.kt)("h3",{id:"431-\u904e\u671f\u6a21\u578bexpiration-model"},"4.3.1 \u904e\u671f\u6a21\u578b(Expiration Model)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7de9\u5b58\u53ef\u7528\u72c0\u614b fresh(\u65b0\u9bae)"),(0,r.kt)("li",{parentName:"ul"},"\u7de9\u5b58\u4e0d\u53ef\u7528\u72c0\u614b stale(\u4e0d\u65b0\u9bae)")),(0,r.kt)("admonition",{title:"Discussion",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u4f60\u6709\u7528\u904e Expires, Cache-Control \u7684\u7d93\u9a57\u55ce\uff1f")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"HTTP \u6642\u9593\u683c\u5f0f, \u53ea\u80fd\u7528 GMT \u6642\u5340")),(0,r.kt)("h3",{id:"432-\u9a57\u8b49\u6a21\u578bvalidation-model"},"4.3.2 \u9a57\u8b49\u6a21\u578b(Validation Model)"),(0,r.kt)("p",null,"\u6700\u5f8c\u66f4\u65b0\u6703\u586b\u5728 Last-Modified, ETag"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Last-Modified: Tue, 01 Jul 2014 00:00:00 GMT\nETag: "ff39b31e285573ee373af0d492aca581"\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"- MD5, SHA1\n")),(0,r.kt)("p",null,"\u5f37\u6821\u9a57\u548c\u5f31\u6821\u9a57"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"123456789" -- \u4e00\u500b\u5f37ETag\u9a57\u8b49\u7b26\nW/"123456789" -- \u4e00\u500b\u5f31ETag\u9a57\u8b49\u7b26\n')),(0,r.kt)("admonition",{title:"Discussion",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u4f60\u6709\u505a\u904e\u9a57\u8b49\u6a21\u578b\u7684\u76f8\u95dc\u529f\u80fd\u55ce\uff1f")),(0,r.kt)("h3",{id:"433-\u555f\u767c\u5f0f\u904e\u671fheuristic-expiration"},"4.3.3 \u555f\u767c\u5f0f\u904e\u671f(Heuristic Expiration)"),(0,r.kt)("p",null,"client \u7aef\u6839\u64da server \u7aef\u7684\u66f4\u65b0\u983b\u7387,\u5177\u9ad4\u72c0\u614b\u7b49\u8a0a\u606f\uff0c\u81ea\u884c\u6c7a\u5b9a\u7de9\u5b58\u6642\u9593\u3002"),(0,r.kt)("h3",{id:"434-\u4e0d\u5e0c\u671b\u5be6\u65bd\u7de9\u5b58\u7684\u60c5\u6cc1"},"4.3.4 \u4e0d\u5e0c\u671b\u5be6\u65bd\u7de9\u5b58\u7684\u60c5\u6cc1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Cache-Control: no-cache\n")),(0,r.kt)("h3",{id:"435-\u4f7f\u7528-vary-\u4f86\u6307\u5b9a\u7de9\u5b58\u55ae\u4f4d"},"4.3.5 \u4f7f\u7528 Vary \u4f86\u6307\u5b9a\u7de9\u5b58\u55ae\u4f4d"),(0,r.kt)("p",null,"\u670d\u52d9\u5668\u9a45\u52d5\u7684\u5167\u5bb9\u5354\u5546(Server Driven Content Negotiation)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Accept-Language: ja\nVary: Accept-Language\n")),(0,r.kt)("h2",{id:"44-content-type-\u7684\u6307\u5b9a"},"4.4 Content-Type \u7684\u6307\u5b9a"),(0,r.kt)("p",null,"Content-Type \u662f\u4e00\u500b\u7684 HTTP Header\uff0c\u7528\u4f86\u544a\u8a34\u5c0d\u65b9\u81ea\u5df1\u6240\u50b3\u9001\u7684\u9019\u5305 payload \u662f\u4ec0\u9ebc\u6a23\u7684\u985e\u578b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Content-Type: type/subtype [;options]\n\n# Example\nContent-Type: text/html; charset=utf-8\n")),(0,r.kt)("h3",{id:"\u8207-content-type-\u6709\u95dc\u7684\u60c5\u5883"},"\u8207 Content-Type \u6709\u95dc\u7684\u60c5\u5883"),(0,r.kt)("h4",{id:"request-\u6a19\u660e-server-\u7684\u8655\u7406\u65b9\u5f0f"},"Request \u6a19\u660e Server \u7684\u8655\u7406\u65b9\u5f0f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4f8b\u5982\uff0cAWS API Gateway \u5c0d\u65bc\u4e0d\u540c\u7684 request Content-Type \u6709\u4e00\u5957\u9810\u8a2d\u7684",(0,r.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-payload-encodings-workflow.html"},"\u8655\u7406\u65b9\u5f0f"))),(0,r.kt)("h4",{id:"response-\u63a7\u5236\u700f\u89bd\u5668\u7684\u884c\u70ba"},"Response \u63a7\u5236\u700f\u89bd\u5668\u7684\u884c\u70ba"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Github \u7528",(0,r.kt)("inlineCode",{parentName:"li"},"text/plain"),"\u50b3\u9001\u7684 JS Source code \u5167\u5bb9\uff0c\u8b93\u700f\u89bd\u5668\u76f4\u63a5\u6aa2\u8996 source code \u800c\u4e0d\u6703\u88ab\u610f\u5916\u57f7\u884c\n",(0,r.kt)("a",{parentName:"li",href:"https://raw.githubusercontent.com/NoobTechNote/NoobTechNote.github.io/main/sidebars.js"},"https://raw.githubusercontent.com/NoobTechNote/NoobTechNote.github.io/main/sidebars.js"))),(0,r.kt)("p",null,"\u5982\u679c\u5728 HTML \u5167\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"<script>"),"Tag \u5b58\u53d6\u4e0a\u9762\u7684 js link\uff0c\u6703\u5f97\u5230\u932f\u8aa4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Refused to execute script from 'https://raw.githubusercontent.com/NoobTechNote/NoobTechNote.github.io/main/sidebars.js'\nbecause its MIME type ('application/json') is not executable, and strict MIME type checking is enabled.\n")),(0,r.kt)("admonition",{title:"Notice",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u4e00\u500b\u5e38\u898b\u7684\u932f\u8aa4\u5176\u5be6\u662f\u4f7f\u7528Content-Type: text/html\u50b3\u9001Javascript\u5167\u5bb9\u7d66\u524d\u7aef\u3002\u5982\u679c\u4f60\u90fd\u9047\u904e\u9019\u985e\u554f\u984c\uff0c\u662f\u56e0\u70ba\u4f60\u7528\u7684Backend Framework\u6709\u5728\u5e6b\u4f60\u8655\u7406Response\u7684Content-Type"),(0,r.kt)("p",{parentName:"admonition"},"\u4f8b\u5982 PHP \u7684 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/symfony/symfony/blob/6.2/src/Symfony/Component/HttpFoundation/Response.php#L259"},"Symfony Response"))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"\u700f\u89bd\u5668\u5176\u5be6\u4e0d\u7e3d\u662f\u6703\u807d Content-Type \u7684\u610f\u601d\uff0c\u6709\u6642\u6703\u4f9d\u7167\u5167\u5bb9\u731c\u6e2c\uff0c\u8a72\u7528\u4ec0\u9ebc\u884c\u70ba\u8655\u7406\u9019\u500b HTTP response"),(0,r.kt)("p",{parentName:"admonition"},"X-Content-Type-Options: nosniff \u53ef\u4ee5\u5354\u52a9\u4f60\u963b\u6b62\u700f\u89bd\u5668\u731c\u6e2c response \u5167\u5bb9\u5c0e\u81f4\u975e\u9810\u671f\u7684\u884c\u70ba")),(0,r.kt)("h3",{id:"response-\u7684-content-type"},"Response \u7684 Content Type"),(0,r.kt)("h4",{id:"\u5e38\u898b\u7684-content-type"},"\u5e38\u898b\u7684 Content-Type"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Content-Type"),(0,r.kt)("th",{parentName:"tr",align:null},"\u542b\u7fa9"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"text/plain"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7d14\u6587\u5b57 ",(0,r.kt)("a",{parentName:"td",href:"#anchor1"},"(\u8a3b 1)"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"text/html"),(0,r.kt)("td",{parentName:"tr",align:null},"HTML \u6587\u4ef6 ",(0,r.kt)("a",{parentName:"td",href:"#anchor1"},"(\u8a3b 1)"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/xml"),(0,r.kt)("td",{parentName:"tr",align:null},"XML \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/rss+xml"),(0,r.kt)("td",{parentName:"tr",align:null},"RSS XML \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/json"),(0,r.kt)("td",{parentName:"tr",align:null},"JSON \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"text/css"),(0,r.kt)("td",{parentName:"tr",align:null},"CSS \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/javascript"),(0,r.kt)("td",{parentName:"tr",align:null},"Javascript \u7a0b\u5f0f\uff0c\u820a\u7a31 text/javascript\uff0c\u4f46\u5728",(0,r.kt)("a",{parentName:"td",href:"https://datatracker.ietf.org/doc/html/rfc4329#page-9"},"RFC4329"),"\u5ee2\u9664")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"multipart/form-data"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8868\u55ae\u8cc7\u6599\uff0c\u5e38\u7528\u5728 Form POST Request")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",{id:"anchor1"},(0,r.kt)("strong",null,"\u8a3b1"),"\uff1a \u8a9e\u610f\u4e0a\u5176\u5be6\u8a72\u5c6c\u65bc",(0,r.kt)("code",null,"application/"),"\uff0c\u4f46\u56e0\u70ba\u6b77\u53f2\u56e0\u7d20\u7dad\u6301",(0,r.kt)("code",null,"text/"),"\u5206\u985e"),(0,r.kt)("h4",{id:"x--\u958b\u982d\u7684-content-type"},"X- \u958b\u982d\u7684 Content Type"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"x-"),"\u958b\u982d\u7684 Content Type \u4ee3\u8868\u6c92\u6709\u5728 IANA \u8a3b\u518a\uff0c\u901a\u5e38\u5177\u5099\u7279\u6b8a\u7528\u9014\uff0c\u6216\u662f\u81ea\u5b9a\u7fa9\u7684 Content Type \u6703\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"x-"),"\u958b\u982d\u53bb\u5b9a\u7fa9\uff0c\u4f8b\u5982"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Content Type"),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/x-msgpack"),(0,r.kt)("td",{parentName:"tr",align:null},"MessagePack")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/x-yaml"),(0,r.kt)("td",{parentName:"tr",align:null},"YAML \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/x-plist"),(0,r.kt)("td",{parentName:"tr",align:null},"Mac \u7684 property list\uff0c\u5e38\u898b\u65bc\u4e0b\u8f09 iOS App \u7684\u5f15\u5c0e")))),(0,r.kt)("p",null,"\u4f46\uff0c\u56e0\u70ba\u6b77\u53f2\u56e0\u7d20\uff0c\u6709\u4e9b",(0,r.kt)("inlineCode",{parentName:"p"},"x-"),"\u958b\u982d\u7684 Content Type \u662f\u6709\u5728 IANA \u8a3b\u518a\u7684"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Content Type"),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/x-javascript"),(0,r.kt)("td",{parentName:"tr",align:null},"Javascript \u7a0b\u5f0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"application/x-json"),(0,r.kt)("td",{parentName:"tr",align:null},"JSON \u6587\u4ef6")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"image/x-png"),(0,r.kt)("td",{parentName:"tr",align:null},"PNG \u5716\u7247")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"x-www-form-urlencoded"),(0,r.kt)("td",{parentName:"tr",align:null},"HTML Form ",(0,r.kt)("a",{parentName:"td",href:"#anchor2"},"(\u8a3b 2)"))))),(0,r.kt)("p",{id:"anchor2"},(0,r.kt)("strong",null,"\u8a3b2"),"\uff1a\u7528`x-www-form-urlencoded`\u50b3\u9001\u7684\u8cc7\u6599\uff0c\u5373\u4f7f\u4f60\u7528POST\u50b3\u9001\uff0c\u4f46\u5be6\u969b\u4e0a\u6703\u88ab\u505aURL Encode\u653e\u5728URL\u4e0a\u3002\u56e0\u70baURL\u7121\u6cd5\u52a0\u5bc6\uff0c\u5982\u679c\u5e36\u6709\u654f\u611f\u8a0a\u606f\u5f88\u5bb9\u6613\u6703\u88ab\u5404\u7a2elog\u6216\u4e2d\u9593\u4eba\u6514\u622a"),(0,r.kt)("h4",{id:"\u81ea\u5b9a\u7fa9\u7684-content-type"},"\u81ea\u5b9a\u7fa9\u7684 Content Type"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc6838#section-3"},"RFC6838"),"\u6709\u898f\u5b9a\u4e00\u7d44\uff0c\u5982\u679c\u4f60\u9700\u8981\u81ea\u5df1\u5b9a\u7fa9 Content Type \u6642\u7684\u53c3\u8003"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Standard Tree: \u7121\u524d\u7db4\uff0c\u6a19\u6e96\u4e2d\u6709\u5b9a\u7fa9\u7684 content-type\uff0c\u5c6c\u65bc\u88ab\u4fdd\u7559\u7684\u4e00\u7fa4"),(0,r.kt)("li",{parentName:"ul"},"Vendor Tree: ",(0,r.kt)("inlineCode",{parentName:"li"},"vnd"),"\uff0c\u6709\u88ab IANA \u8a8d\u8b49\u904e\u7684\u516c\u53f8\u4f7f\u7528\u3002\u901a\u5e38\u6703\u88ab\u5927\u7bc4\u570d\u4f7f\u7528\uff0c\u4f46\u7531\u7279\u5b9a\u516c\u53f8\u7ba1\u7406",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"application/vnd.ms-excel"),(0,r.kt)("li",{parentName:"ul"},"application/vnd.github.v3+json"))),(0,r.kt)("li",{parentName:"ul"},"Personal Tree: ",(0,r.kt)("inlineCode",{parentName:"li"},"prs."),"\uff0c\u500b\u4eba\u4f7f\u7528\uff0c\u6216\u5be6\u9a57\u6027\u7528\u9014\uff0c\u53ea\u5728\u975e\u516c\u958b\u7684\u72c0\u6cc1\u4e0b\u88ab\u4f7f\u7528",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"appliccation/prs.mech.v1+json"))),(0,r.kt)("li",{parentName:"ul"},"Unregistered Tree: ",(0,r.kt)("inlineCode",{parentName:"li"},"x."),"\uff0c\u50c5\u79c1\u6709\u4f7f\u7528\uff0c\u4e0d\u80fd\u88ab\u8a3b\u518a")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"\u6ce8\u610f",(0,r.kt)("inlineCode",{parentName:"p"},"x."),"\u8ddf",(0,r.kt)("inlineCode",{parentName:"p"},"x-"),"\u662f\u4e0d\u540c\u7684\uff0c\u5f8c\u8005\u662f\u6709\u53ef\u80fd\u88ab\u8a3b\u518a\u6210\u6a19\u6e96\u7684\u4e00\u90e8\u4efd")),(0,r.kt)("admonition",{title:"Discussion",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u4f60\u6709\u7528\u904e\u975e\u6a19\u6e96\u7684Content Type\u55ce\uff1f\u597d\u7528\u55ce\uff1f\u5728\u4ee5\u4e0b\u4f8b\u5b50\u4e2d\uff0cGithub\u7684API\u70ba\u4ec0\u9ebc\u9019\u9ebc\u56de\u61c9\uff1f"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\nServer: Github.com\nContent-Type: application/json; charset=utf-8\nX-GitHub-Media-Type: github.v3\n"))),(0,r.kt)("h3",{id:"request-\u7684-content-type"},"Request \u7684 Content Type"),(0,r.kt)("p",null,"Accept: \u6211\u80fd\u5920\u5403\u600e\u6a23\u7684Response\u683c\u5f0f\nContent-Type: \u5ba3\u544a\u76ee\u524d\u50b3\u9001\u7684payload\u662f\u600e\u6a23\u7684\u683c\u5f0f"),(0,r.kt)("h4",{id:"accept-header"},"Accept Header"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"q"),"\u53ef\u4ee5\u6307\u5b9a\u512a\u5148\u7d1a\uff0c\u6578\u5b57\u8d8a\u5927\u512a\u5148\u6b0a\u8d8a\u9ad8\uff0c\u9810\u8a2d\u662f\u6700\u9ad8",(0,r.kt)("inlineCode",{parentName:"li"},"1")),(0,r.kt)("li",{parentName:"ul"},"\u6240\u6709\u56de\u61c9\u683c\u5f0f\u90fd\u5403\u7684\u8a71\uff0c\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"*/*"))),(0,r.kt)("p",null,"\u7ffb\u8b6f\uff1a",(0,r.kt)("em",{parentName:"p"},"\u6211\u5403 html, xhtml\uff0c\u4f46\u5982\u679c\u90fd\u6c92\u6709\u7684\u8a71\uff0c\u4e5f\u53ef\u4ee5\u7d66\u6211 xml\uff0c\u518d\u6c92\u6709\u53ef\u4ee5\u7d66\u6211 webp\uff0c\u771f\u7684\u6c92\u8fa6\u6cd5\u5c31\u96a8\u4fbf\u5427")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Accept: text/html,application/xhtml+xml,application/xml;q=0.9;image/webp,*/*;q=0.8\n")),(0,r.kt)("p",null,"\u7ffb\u8b6f\uff1a",(0,r.kt)("em",{parentName:"p"},"\u6211\u5403 json\uff0c\u4f46\u6c92\u8fa6\u6cd5\u7684\u8a71 xml \u4e5f\u53ef\u4ee5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Accept: application/json,application/xml;q=0.9\n")),(0,r.kt)("h4",{id:"vary-accept"},"Vary: Accept"),(0,r.kt)("p",null,"\u5728\u6709 API Gateway, Reversed Proxy \u5b58\u5728\u8acb\u6c42\u7aef\u8207\u4f3a\u670d\u7aef\u7684\u4e2d\u9593\u6642\uff0cAccept Header \u6709\u53ef\u80fd\u6703\u88ab\u6539\u8b8a\u3002"),(0,r.kt)("p",null,"\u6b64\u6642\u9700\u8981\u52a0\u4e0a",(0,r.kt)("inlineCode",{parentName:"p"},"Vary: Accept")," Header \u8981\u6c42 Gateway \u8f49\u4ea4 Accept Header \u6216\u505a\u9032\u4e00\u6b65\u8655\u7406"),(0,r.kt)("h2",{id:"45-same-origin-policy-\u8207-cors"},"4.5 Same Origin Policy \u8207 CORS"),(0,r.kt)("p",null,"\u4e3b\u8981\u662f\u5b89\u5168\u8003\u91cf\uff0c\u700f\u89bd\u5668\u53ea\u5141\u8a31\u5f9e\u76f8\u540c\u7684\u4f86\u6e90(Origin)\u8b80\u53d6\u8cc7\u6599"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"URL"),(0,r.kt)("th",{parentName:"tr",align:null},"Outcome\tReason"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"http://store.company.com/dir2/other.html"},"http://store.company.com/dir2/other.html")),(0,r.kt)("td",{parentName:"tr",align:null},"Same origin\tOnly the path differs")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"http://store.company.com/dir/inner/another.html"},"http://store.company.com/dir/inner/another.html")),(0,r.kt)("td",{parentName:"tr",align:null},"Same origin\tOnly the path differs")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://store.company.com/page.html"},"https://store.company.com/page.html")),(0,r.kt)("td",{parentName:"tr",align:null},"Failure Different protocol")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"http://store.company.com:81/dir/page.html"},"http://store.company.com:81/dir/page.html")),(0,r.kt)("td",{parentName:"tr",align:null},"Failure\tDifferent port (http:// is port 80 by default)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"http://news.company.com/dir/page.html"},"http://news.company.com/dir/page.html")),(0,r.kt)("td",{parentName:"tr",align:null},"Failure\tDifferent host")))),(0,r.kt)("p",null,"(\u8868\u683c\u4f86\u81ea",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy"},"MDN"),")"),(0,r.kt)("h3",{id:"cors\u8de8\u57df\u8acb\u6c42"},"CORS\u8de8\u57df\u8acb\u6c42"),(0,r.kt)("p",null,"\u5982\u679c\u8981\u7a81\u7834Origin\u7684\u9650\u5236\uff0c\u6703\u9700\u8981\u4e00\u4e9b\u984d\u5916\u7684\u4f5c\u6cd5\u3002\u4e00\u822c\u4f86\u8aaa\u6c92\u8fa6\u6cd5\u524d\u7aef\u81ea\u5df1\u505a\uff0c\u9700\u8981server\u914d\u5408"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u7c21\u55ae\u4f86\u8aaa\uff0c\u8981\u9054\u6210CORS\u4f60\u9700\u8981\u8a2d\u5b9a\u8b93",(0,r.kt)("strong",{parentName:"p"},"\u88ab\u5b58\u53d6\u7684\u6578\u64da"),"\u5141\u8a31\u524d\u7aef\u904e\u4f86\u5b58\u53d6\u3002\u4e5f\u5c31\u662f\u8aaa\uff0c\u5982\u679c\u4f60\u4e0d\u662f\u6578\u64da\u6216API\u7684\u63d0\u4f9b\u65b9\u6216\u6c92\u6709\u6b0a\u9650\u66f4\u52d5\u5176\u884c\u70ba\uff0c\u4f60\u6c92\u8fa6\u6cd5\u8fa6\u5230CORS")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Server response\u7684",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"},"Access-Control-Allow-Origin"),"\u7cfb\u5217Headers",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Credentials"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Headers"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Methods"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Origin"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Expose-Headers"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Max-Age"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Request-Headers"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Request-Method")))),(0,r.kt)("p",null,"\u53e6\u5916\uff0c",(0,r.kt)("a",{parentName:"p",href:"https://zh.m.wikipedia.org/zh-tw/JSONP"},"JSONP"),"\u4e5f\u662f\u4e00\u7a2e\u65b9\u5f0f\uff0c\u4f46\u4f9d\u7136\u9700\u8981Server\u914d\u5408"),(0,r.kt)("h3",{id:"cors\u7684pre-flight-request"},"CORS\u7684Pre-flight Request"),(0,r.kt)("p",null,"\u5728\u9001\u51fa\u771f\u7684CORS\u8cc7\u6599\u8acb\u6c42\u4e4b\u524d\uff0cBrowser\u6703\u9810\u5148\u767c\u8d77\u4e00\u500b",(0,r.kt)("inlineCode",{parentName:"p"},"OPTION"),"\u8acb\u6c42\uff0c\u63a2\u7d22\u5c0d\u65b9\u662f\u5426\u5141\u8a31CORS"),(0,r.kt)("p",null,"\u700f\u89bd\u5668\u6703\u767c\u8d77Pre-flight Request\u7684\u689d\u4ef6"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Request Method\u4e0d\u662fHEAD/GET/POST"),(0,r.kt)("li",{parentName:"ul"},"Request Header\u6c92\u6709\u5e36\u6709\u9019\u4e9bheaders",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Accept"),(0,r.kt)("li",{parentName:"ul"},"Accept-Language"),(0,r.kt)("li",{parentName:"ul"},"Content-Language"),(0,r.kt)("li",{parentName:"ul"},"Content-Type"))),(0,r.kt)("li",{parentName:"ul"},"Content-Type header\u4e0d\u662f\u9019\u4e9b\u985e\u578b",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"application/x-www-form-urlencoded"),(0,r.kt)("li",{parentName:"ul"},"multipart/form-data"),(0,r.kt)("li",{parentName:"ul"},"text/plain")))),(0,r.kt)("p",null,"Pre-flight\u7684\u8acb\u6c42\u8207\u56de\u61c9\u6703\u9577\u5f97\u50cf\u9019\u6a23\uff0c\u4e0b\u5217\u7bc4\u4f8b\u4f86\u81ea",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request"},"MDN")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"OPTIONS /resource/foo\nAccess-Control-Request-Method: DELETE # \u6211\u53ef\u4ee5\u6253DELETE\u55ce\uff1f\nAccess-Control-Request-Headers: origin, x-requested-with\nOrigin: https://foo.bar.org # \u900f\u904e\u9019\u500bOrigin\u4f86\u6253\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"HTTP/1.1 204 No Content\nConnection: keep-alive\nAccess-Control-Allow-Origin: https://foo.bar.org # \u900f\u904e\u9019\u500bOrigin\nAccess-Control-Allow-Methods: POST, GET, OPTIONS, DELETE # \u4f60\u53ef\u4ee5\u6253POST, GET, OPTIONS, DELETE\u5594\nAccess-Control-Max-Age: 86400\n")),(0,r.kt)("h3",{id:"\u6848\u4f8bpchome24\u8cfc\u7269\u6539\u7248"},"\u6848\u4f8b\uff1aPCHome24\u8cfc\u7269\u6539\u7248"),(0,r.kt)("p",null,"\u6700\u8fd1\u6b63\u7d05\u7684PCHome24\u9996\u9801\u6539\u7248\uff0c\u6709\u500bconsole error"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(34911).Z,width:"1349",height:"665"})),(0,r.kt)("admonition",{title:"Discussion",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u554f\u984c\u662f\u51fa\u5728\u54ea\u88e1\u5462\uff1f")),(0,r.kt)("p",null,"Request"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Request URL: https://tracker-api.netforce.com.tw/cdp-rawdata-pchome24h\nRequest Method: POST\nStatus Code: 200\nRemote Address: [2606:4700:3037::6815:a4f]:443\nReferrer Policy: strict-origin-when-cross-origin\n")),(0,r.kt)("p",null,"Response"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'alt-svc: h3=":443"; ma=86400, h3-29=":443"; ma=86400\ncf-cache-status: DYNAMIC\ncf-ray: 72c472df0a92969a-SJC\ncontent-type: application/vnd.kafka.v2+json\ndate: Sun, 17 Jul 2022 16:45:34 GMT\nexpect-ct: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"\nnel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}\nreport-to: {"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v3?s=EZifM3cYBLYijrHeUK7pUWwnKJEUJIjNIzo5mU7asCrGl7PPkWbQarf5AvRCrX0JIsneDPEKhEz%2BGi5%2Bjto1zvadqJ8rXZIDMEUYiYC9ScTAGj%2FrBX5AZ5g2Ucaw2hvaC3E8ntIamQn4k%2B2mZyIS07cq%2FriFuoqqPK8%3D"}],"group":"cf-nel","max_age":604800}\nserver: cloudflare\nvary: Accept-Encoding, User-Agent\nvia: 1.1 22d43bf299ac98b08849f5a01a8af246.cloudfront.net (CloudFront)\nx-amz-apigw-id: Va5rOHz7tjMFYgQ=\nx-amz-cf-id: 9gowKMyAERvJZore7__TUIe8vr1I5FUWH_BxiPvV59xbbRvzDDhRmg==\nx-amz-cf-pop: SFO5-P2\nx-amzn-remapped-date: Sun, 17 Jul 2022 16:45:34 GMT\nx-amzn-requestid: 2dc54a16-6928-4a7a-b195-dda519176780\nx-cache: Miss from cloudfront\n')),(0,r.kt)("h3",{id:"\u53c3\u8003\u8cc7\u6599"},"\u53c3\u8003\u8cc7\u6599"),(0,r.kt)("p",null,"\u95dc\u65bcSame Origin Policy\u5f88\u4e0d\u932f\u7684\u53c3\u8003\u8cc7\u6599"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://medium.com/starbugs/%E5%BC%84%E6%87%82%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96-same-origin-policy-%E8%88%87%E8%B7%A8%E7%B6%B2%E5%9F%9F-cors-e2e5c1a53a19"},"Hannah - \u7c21\u55ae\u5f04\u61c2\u540c\u6e90\u653f\u7b56 (Same Origin Policy) \u8207\u8de8\u7db2\u57df (CORS)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://medium.com/%E7%A8%8B%E5%BC%8F%E7%8C%BF%E5%90%83%E9%A6%99%E8%95%89/same-origin-policy-%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96-%E4%B8%80%E5%88%87%E5%AE%89%E5%85%A8%E7%9A%84%E5%9F%BA%E7%A4%8E-36432565a226"},"Jayden - \u7db2\u7ad9\u5b89\u5168\ud83d\udd12 Same Origin Policy \u540c\u6e90\u653f\u7b56 ! \u4e00\u5207\u5b89\u5168\u7684\u57fa\u790e"))),(0,r.kt)("h2",{id:"46-\u5b9a\u7fa9\u79c1\u6709\u7684-http-header"},"4.6 \u5b9a\u7fa9\u79c1\u6709\u7684 HTTP Header"),(0,r.kt)("p",null,"\u8981\u5b9a\u7fa9\u79c1\u6709\u7528\u9014\u7684HTTP Header\u8acb\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"X-"),"\u958b\u982d\uff0c\u4e0d\u80fd\u8aaa\u662f\u4e00\u7a2e\u786c\u6027\u898f\u5b9a\uff0c\u4f46\u662f\u6bd4\u8f03\u5bb9\u6613\u88ab\u8b58\u5225"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"X-Github-Request-Id")),(0,r.kt)("p",null,"\u4e5f\u6709\u4e0d\u5c11\u6163\u4f8b\uff0c\u6216\u662fIANA\u898f\u5b9a\u7684Header\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"X-"),"\u958b\u982d\uff0c\u9700\u8981\u5b9a\u7fa9\u79c1\u6709Header\u6642\u9084\u662f\u8981\u907f\u958b\u3002\u4f8b\u5982\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"X-Forwarded-For"),(0,r.kt)("li",{parentName:"ul"},"X-Forwarded-Host"),(0,r.kt)("li",{parentName:"ul"},"X-Forwarded-Proto"),(0,r.kt)("li",{parentName:"ul"},"X-Frame-Options"),(0,r.kt)("li",{parentName:"ul"},"X-XSS-Protection"),(0,r.kt)("li",{parentName:"ul"},"X-Content-Type-Options"),(0,r.kt)("li",{parentName:"ul"},"X-DNS-Prefetch-Control")),(0,r.kt)("h3",{id:"http-header\u7684\u8c46\u77e5\u8b58"},"HTTP Header\u7684\u8c46\u77e5\u8b58"),(0,r.kt)("h4",{id:"1-\u653e\u5728header\u7684\u8cc7\u8a0a\u70ba\u4e86\u76f8\u5bb9\u6027\u7e3d\u548c\u4e0d\u8981\u8d85\u904e8kb"},"1. \u653e\u5728header\u7684\u8cc7\u8a0a\uff0c\u70ba\u4e86\u76f8\u5bb9\u6027\uff0c\u7e3d\u548c\u4e0d\u8981\u8d85\u904e8KB"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Apache 2.4 ",(0,r.kt)("a",{parentName:"p",href:"https://httpd.apache.org/docs/2.4/mod/core.html#limitrequestfieldsize"},"Http Header Limit"),"\u662f8KB"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u9055\u80cc\u7684\u8a71\u6703return HTTP 413 Entity Too Large"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Set-Cookie\u4e5f\u662f\u4e00\u7a2eheader\uff0c\u6240\u4ee5\u4e5f\u4e0d\u8981\u5728Cookie\u5167\u8a2d\u5b9a\u592a\u591a\u6771\u897f"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u771f\u7684\u6709\u9700\u8981\u66f4\u5927\u7684\u7a7a\u9593\uff0c\u5728JS Runtime\u7528LocalStorage, WebSQL, IndexedDB")))),(0,r.kt)("h4",{id:"2-header-name\u662fcase-insensitive\u7684"},"2. Header Name\u662fcase-insensitive\u7684"),(0,r.kt)("h4",{id:"3-header\u7684\u9806\u5e8f\u4e0d\u91cd\u8981\u55ce"},"3. Header\u7684\u9806\u5e8f\u4e0d\u91cd\u8981(\u55ce\uff1f)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u53c3\u8003",(0,r.kt)("a",{parentName:"li",href:"https://www.rfc-editor.org/rfc/rfc2616#section-4.2"},"RFC2616 4.2 Message Headers")),(0,r.kt)("li",{parentName:"ul"},"\u4f46\u5982\u679c\u4f60\u6709\u591a\u500b\u540c\u540d\u7684Header\uff0c\u6703\u6709\u8986\u84cb\u554f\u984c"),(0,r.kt)("li",{parentName:"ul"},"\u56e0\u70ba\u6548\u7387\u554f\u984c\uff0c\u6709CDN\u6703\u5728\u4f60\u6539\u8b8a\u91cd\u8981Header\u7684\u9806\u5e8f\u6642\u6709\u4e0d\u540c\u7684\u7d50\u679c",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://sansec.io/research/http-header-order-is-important"},"Why ordering HTTP headers is important")),(0,r.kt)("li",{parentName:"ul"},"\u9019\u7bc7\u6587\u7ae0\u6709\u57282017\u4e0a",(0,r.kt)("a",{parentName:"li",href:"https://news.ycombinator.com/item?id=14245577"},"Hacker News"))))))}k.isMDXComponent=!0},51718:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/http_request_message_format-da749205ab80249c98c6e2a892a7b01b.png"},66506:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/http_response_message_format-1371b22bf2adecfce111172b1593c7f8.png"},34911:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/pchome_cors_mime_error-2d051f2f80d0db6d4eb72287b013cd9d.png"}}]);